# Music21 MCP Server - Enterprise Configuration
# Production-ready configuration with security, monitoring, and resilience

# Environment Configuration
DEPLOYMENT_ENV=production
DEBUG_MODE=false

# Security Configuration
SECURITY_ENABLED=true
REQUIRE_AUTH=true
OAUTH_ISSUER=https://music21-mcp.your-domain.com
OAUTH_CLIENT_ID=music21_mcp_production_client
OAUTH_CLIENT_SECRET=your_secure_client_secret_here
OAUTH_REDIRECT_URI=https://your-app.com/oauth/callback

# Input Validation
STRICT_VALIDATION=true
ENABLE_INPUT_SANITIZATION=true
ALLOWED_FILE_EXTENSIONS=.mid,.midi,.xml,.musicxml,.mxl,.abc,.krn,.mei

# Monitoring Configuration
METRICS_ENABLED=true
MONITORING_ENABLED=true
PROMETHEUS_MULTIPROC_DIR=/var/lib/prometheus/multiproc
PROMETHEUS_PORT=9090

# OpenTelemetry Configuration
OTEL_ENABLED=true
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_SERVICE_NAME=music21-mcp-server
OTEL_SERVICE_VERSION=1.0.0

# Performance Configuration
MAX_CONCURRENT_REQUESTS=50
REQUEST_TIMEOUT=30.0
MAX_ANALYSIS_DURATION=300.0
ENABLE_CACHING=true
CACHE_TTL=3600

# Resource Limits
MAX_MEMORY_GB=8.0
MAX_CPU_PERCENT=80.0
MAX_FILE_SIZE_MB=50
MAX_SCORES_IN_MEMORY=1000

# Circuit Breaker Configuration
CB_FAILURE_THRESHOLD=5
CB_RECOVERY_TIMEOUT=60.0
CB_MONITORING_WINDOW=120.0
CB_ENABLE_ADAPTIVE=true

# Bulkhead Configuration
BH_MAX_CONCURRENT_ANALYSIS=10
BH_MAX_QUEUE_SIZE=100
BH_TIMEOUT_SECONDS=30.0

# Retry Configuration
RETRY_MAX_ATTEMPTS=3
RETRY_BASE_DELAY=1.0
RETRY_MAX_DELAY=30.0
RETRY_EXPONENTIAL_BASE=2.0

# Rate Limiting
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_REQUESTS_PER_HOUR=5000
RATE_LIMIT_BURST_THRESHOLD=20
RATE_LIMIT_LOCKOUT_DURATION=300

# Audit Logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_DIRECTORY=/var/log/music21_mcp/audit
AUDIT_RETENTION_DAYS=2555  # 7 years for compliance
AUDIT_ANONYMIZE_IPS=true
AUDIT_ENCRYPTION_ENABLED=true

# Security Monitoring
SECURITY_MONITORING_ENABLED=true
INTRUSION_DETECTION_ENABLED=true
ANOMALY_DETECTION_ENABLED=true
THREAT_INTELLIGENCE_ENABLED=true

# Network Security
ALLOWED_ORIGINS=https://your-app.com,https://your-admin.com
ENABLE_CORS=true
ENABLE_CSRF_PROTECTION=true
SECURE_HEADERS=true

# SSL/TLS Configuration
SSL_ENABLED=true
SSL_CERT_PATH=/etc/ssl/certs/music21-mcp.crt
SSL_KEY_PATH=/etc/ssl/private/music21-mcp.key
SSL_VERIFY_CLIENT=false

# Database Configuration (if using external storage)
DB_ENABLED=false
DB_HOST=localhost
DB_PORT=5432
DB_NAME=music21_mcp
DB_USER=music21_user
DB_PASSWORD=your_secure_db_password
DB_SSL_MODE=require

# Redis Configuration (for caching and session storage)
REDIS_ENABLED=true
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password
REDIS_DB=0
REDIS_SSL=true

# Logging Configuration
LOG_LEVEL=INFO
LOG_FORMAT=structured
LOG_DIRECTORY=/var/log/music21_mcp
LOG_ROTATION_SIZE=100MB
LOG_RETENTION_DAYS=90

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10

# Feature Flags
ENABLE_ADVANCED_ANALYSIS=true
ENABLE_COMPOSITION_TOOLS=true
ENABLE_STYLE_IMITATION=true
ENABLE_AUDIO_ANALYSIS=false  # Requires additional dependencies
ENABLE_COLLABORATIVE_FEATURES=false

# Integration Configuration
ENABLE_WEBHOOK_NOTIFICATIONS=false
WEBHOOK_URL=https://your-app.com/webhooks/music21
WEBHOOK_SECRET=your_webhook_secret

# Backup Configuration
ENABLE_AUTOMATED_BACKUPS=true
BACKUP_DIRECTORY=/var/backups/music21_mcp
BACKUP_RETENTION_DAYS=30
BACKUP_ENCRYPTION_ENABLED=true

# Compliance Configuration
SOC2_COMPLIANCE=true
GDPR_COMPLIANCE=true
HIPAA_COMPLIANCE=false
DATA_RESIDENCY=US

# Development Overrides (for development environment)
# Uncomment and modify for development
# DEPLOYMENT_ENV=development
# DEBUG_MODE=true
# SECURITY_ENABLED=false
# REQUIRE_AUTH=false
# METRICS_ENABLED=true
# MAX_CONCURRENT_REQUESTS=10
# LOG_LEVEL=DEBUG